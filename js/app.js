!function(t){"use strict";function i(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function e(t,i){return i={exports:{}},t(i,i.exports),i.exports}function s(t,i){function e(){this.constructor=t}for(var s in i)i.hasOwnProperty(s)&&(t[s]=i[s]);t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)}function n(t){return t[v]}function o(t){return R.filter(function(i){return 0===t.indexOf(i)})[0]}function a(t){X=t}function r(t,i,e){_t=t,$=i,tt=e,Q=0;for(var s in _t)Q+=_t[s]}var h,u,d,l,p,f,c,g,_,y="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},m=(e(function(t,e){!function(i,s){"object"==typeof e&&void 0!==t?t.exports=s():"function"==typeof define&&define.amd?define(s):i.ES6Promise=s()}(y,function(){function t(t){var i=typeof t;return null!==t&&("object"===i||"function"===i)}function e(t){return"function"==typeof t}function s(t){W=t}function n(t){V=t}function o(){return void 0!==z?function(){z(r)}:a()}function a(){var t=setTimeout;return function(){return t(r,1)}}function r(){for(var t=0;t<M;t+=2){(0,Z[t])(Z[t+1]),Z[t]=void 0,Z[t+1]=void 0}M=0}function h(t,i){var e=this,s=new this.constructor(d);void 0===s[J]&&A(s);var n=e._state;if(n){var o=arguments[n-1];V(function(){return B(n,s,o,e._result)})}else x(e,s,t,i);return s}function u(t){var i=this;if(t&&"object"==typeof t&&t.constructor===i)return t;var e=new i(d);return v(e,t),e}function d(){}function l(){return new TypeError("You cannot resolve a promise with itself")}function p(){return new TypeError("A promises callback cannot return that same promise.")}function f(t){try{return t.then}catch(t){return tt.error=t,tt}}function c(t,i,e,s){try{t.call(i,e,s)}catch(t){return t}}function g(t,i,e){V(function(t){var s=!1,n=c(e,i,function(e){s||(s=!0,i!==e?v(t,e):b(t,e))},function(i){s||(s=!0,w(t,i))},"Settle: "+(t._label||" unknown promise"));!s&&n&&(s=!0,w(t,n))},t)}function _(t,i){i._state===Q?b(t,i._result):i._state===$?w(t,i._result):x(i,void 0,function(i){return v(t,i)},function(i){return w(t,i)})}function m(t,i,s){i.constructor===t.constructor&&s===h&&i.constructor.resolve===u?_(t,i):s===tt?(w(t,tt.error),tt.error=null):void 0===s?b(t,i):e(s)?g(t,i,s):b(t,i)}function v(i,e){i===e?w(i,l()):t(e)?m(i,e,f(e)):b(i,e)}function S(t){t._onerror&&t._onerror(t._result),T(t)}function b(t,i){t._state===X&&(t._result=i,t._state=Q,0!==t._subscribers.length&&V(T,t))}function w(t,i){t._state===X&&(t._state=$,t._result=i,V(S,t))}function x(t,i,e,s){var n=t._subscribers,o=n.length;t._onerror=null,n[o]=i,n[o+Q]=e,n[o+$]=s,0===o&&t._state&&V(T,t)}function T(t){var i=t._subscribers,e=t._state;if(0!==i.length){for(var s=void 0,n=void 0,o=t._result,a=0;a<i.length;a+=3)s=i[a],n=i[a+e],s?B(e,s,n,o):n(o);t._subscribers.length=0}}function k(t,i){try{return t(i)}catch(t){return tt.error=t,tt}}function B(t,i,s,n){var o=e(s),a=void 0,r=void 0,h=void 0,u=void 0;if(o){if(a=k(s,n),a===tt?(u=!0,r=a.error,a.error=null):h=!0,i===a)return void w(i,p())}else a=n,h=!0;i._state!==X||(o&&h?v(i,a):u?w(i,r):t===Q?b(i,a):t===$&&w(i,a))}function F(t,i){try{i(function(i){v(t,i)},function(i){w(t,i)})}catch(i){w(t,i)}}function P(){return it++}function A(t){t[J]=it++,t._state=void 0,t._result=void 0,t._subscribers=[]}function G(){return new Error("Array Methods must be provided an Array")}function R(t){return new et(this,t).promise}function O(t){var i=this;return new i(E(t)?function(e,s){for(var n=t.length,o=0;o<n;o++)i.resolve(t[o]).then(e,s)}:function(t,i){return i(new TypeError("You must pass an array to race."))})}function D(t){var i=this,e=new i(d);return w(e,t),e}function C(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function H(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function I(){var t=void 0;if(void 0!==y)t=y;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var i=t.Promise;if(i){var e=null;try{e=Object.prototype.toString.call(i.resolve())}catch(t){}if("[object Promise]"===e&&!i.cast)return}t.Promise=st}var L=void 0;L=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var E=L,M=0,z=void 0,W=void 0,V=function(t,i){Z[M]=t,Z[M+1]=i,2===(M+=2)&&(W?W(r):q())},U="undefined"!=typeof window?window:void 0,j=U||{},N=j.MutationObserver||j.WebKitMutationObserver,K="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),Y="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Z=new Array(1e3),q=void 0;q=K?function(){return function(){return process.nextTick(r)}}():N?function(){var t=0,i=new N(r),e=document.createTextNode("");return i.observe(e,{characterData:!0}),function(){e.data=t=++t%2}}():Y?function(){var t=new MessageChannel;return t.port1.onmessage=r,function(){return t.port2.postMessage(0)}}():void 0===U&&"function"==typeof i?function(){try{var t=Function("return this")().require("vertx");return z=t.runOnLoop||t.runOnContext,o()}catch(t){return a()}}():a();var J=Math.random().toString(36).substring(2),X=void 0,Q=1,$=2,tt={error:null},it=0,et=function(){function t(t,i){this._instanceConstructor=t,this.promise=new t(d),this.promise[J]||A(this.promise),E(i)?(this.length=i.length,this._remaining=i.length,this._result=new Array(this.length),0===this.length?b(this.promise,this._result):(this.length=this.length||0,this._enumerate(i),0===this._remaining&&b(this.promise,this._result))):w(this.promise,G())}return t.prototype._enumerate=function(t){for(var i=0;this._state===X&&i<t.length;i++)this._eachEntry(t[i],i)},t.prototype._eachEntry=function(t,i){var e=this._instanceConstructor,s=e.resolve;if(s===u){var n=f(t);if(n===h&&t._state!==X)this._settledAt(t._state,i,t._result);else if("function"!=typeof n)this._remaining--,this._result[i]=t;else if(e===st){var o=new e(d);m(o,t,n),this._willSettleAt(o,i)}else this._willSettleAt(new e(function(i){return i(t)}),i)}else this._willSettleAt(s(t),i)},t.prototype._settledAt=function(t,i,e){var s=this.promise;s._state===X&&(this._remaining--,t===$?w(s,e):this._result[i]=e),0===this._remaining&&b(s,this._result)},t.prototype._willSettleAt=function(t,i){var e=this;x(t,void 0,function(t){return e._settledAt(Q,i,t)},function(t){return e._settledAt($,i,t)})},t}(),st=function(){function t(i){this[J]=P(),this._result=this._state=void 0,this._subscribers=[],d!==i&&("function"!=typeof i&&C(),this instanceof t?F(this,i):H())}return t.prototype.catch=function(t){return this.then(null,t)},t.prototype.finally=function(t){var i=this,s=i.constructor;return e(t)?i.then(function(i){return s.resolve(t()).then(function(){return i})},function(i){return s.resolve(t()).then(function(){throw i})}):i.then(t,t)},t}();return st.prototype.then=h,st.all=R,st.race=O,st.resolve=u,st.reject=D,st._setScheduler=s,st._setAsap=n,st._asap=V,st.polyfill=I,st.Promise=st,st})}),e(function(t,e){!function(i,s){"object"==typeof e&&void 0!==t?t.exports=s():"function"==typeof define&&define.amd?define(s):i.ES6Promise=s()}(y,function(){function t(t){var i=typeof t;return null!==t&&("object"===i||"function"===i)}function e(t){return"function"==typeof t}function s(t){W=t}function n(t){V=t}function o(){return void 0!==z?function(){z(r)}:a()}function a(){var t=setTimeout;return function(){return t(r,1)}}function r(){for(var t=0;t<M;t+=2){(0,Z[t])(Z[t+1]),Z[t]=void 0,Z[t+1]=void 0}M=0}function h(t,i){var e=this,s=new this.constructor(d);void 0===s[J]&&A(s);var n=e._state;if(n){var o=arguments[n-1];V(function(){return B(n,s,o,e._result)})}else x(e,s,t,i);return s}function u(t){var i=this;if(t&&"object"==typeof t&&t.constructor===i)return t;var e=new i(d);return v(e,t),e}function d(){}function l(){return new TypeError("You cannot resolve a promise with itself")}function p(){return new TypeError("A promises callback cannot return that same promise.")}function f(t){try{return t.then}catch(t){return tt.error=t,tt}}function c(t,i,e,s){try{t.call(i,e,s)}catch(t){return t}}function g(t,i,e){V(function(t){var s=!1,n=c(e,i,function(e){s||(s=!0,i!==e?v(t,e):b(t,e))},function(i){s||(s=!0,w(t,i))},"Settle: "+(t._label||" unknown promise"));!s&&n&&(s=!0,w(t,n))},t)}function _(t,i){i._state===Q?b(t,i._result):i._state===$?w(t,i._result):x(i,void 0,function(i){return v(t,i)},function(i){return w(t,i)})}function m(t,i,s){i.constructor===t.constructor&&s===h&&i.constructor.resolve===u?_(t,i):s===tt?(w(t,tt.error),tt.error=null):void 0===s?b(t,i):e(s)?g(t,i,s):b(t,i)}function v(i,e){i===e?w(i,l()):t(e)?m(i,e,f(e)):b(i,e)}function S(t){t._onerror&&t._onerror(t._result),T(t)}function b(t,i){t._state===X&&(t._result=i,t._state=Q,0!==t._subscribers.length&&V(T,t))}function w(t,i){t._state===X&&(t._state=$,t._result=i,V(S,t))}function x(t,i,e,s){var n=t._subscribers,o=n.length;t._onerror=null,n[o]=i,n[o+Q]=e,n[o+$]=s,0===o&&t._state&&V(T,t)}function T(t){var i=t._subscribers,e=t._state;if(0!==i.length){for(var s=void 0,n=void 0,o=t._result,a=0;a<i.length;a+=3)s=i[a],n=i[a+e],s?B(e,s,n,o):n(o);t._subscribers.length=0}}function k(t,i){try{return t(i)}catch(t){return tt.error=t,tt}}function B(t,i,s,n){var o=e(s),a=void 0,r=void 0,h=void 0,u=void 0;if(o){if(a=k(s,n),a===tt?(u=!0,r=a.error,a.error=null):h=!0,i===a)return void w(i,p())}else a=n,h=!0;i._state!==X||(o&&h?v(i,a):u?w(i,r):t===Q?b(i,a):t===$&&w(i,a))}function F(t,i){try{i(function(i){v(t,i)},function(i){w(t,i)})}catch(i){w(t,i)}}function P(){return it++}function A(t){t[J]=it++,t._state=void 0,t._result=void 0,t._subscribers=[]}function G(){return new Error("Array Methods must be provided an Array")}function R(t){return new et(this,t).promise}function O(t){var i=this;return new i(E(t)?function(e,s){for(var n=t.length,o=0;o<n;o++)i.resolve(t[o]).then(e,s)}:function(t,i){return i(new TypeError("You must pass an array to race."))})}function D(t){var i=this,e=new i(d);return w(e,t),e}function C(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function H(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function I(){var t=void 0;if(void 0!==y)t=y;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var i=t.Promise;if(i){var e=null;try{e=Object.prototype.toString.call(i.resolve())}catch(t){}if("[object Promise]"===e&&!i.cast)return}t.Promise=st}var L=void 0;L=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var E=L,M=0,z=void 0,W=void 0,V=function(t,i){Z[M]=t,Z[M+1]=i,2===(M+=2)&&(W?W(r):q())},U="undefined"!=typeof window?window:void 0,j=U||{},N=j.MutationObserver||j.WebKitMutationObserver,K="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),Y="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Z=new Array(1e3),q=void 0;q=K?function(){return function(){return process.nextTick(r)}}():N?function(){var t=0,i=new N(r),e=document.createTextNode("");return i.observe(e,{characterData:!0}),function(){e.data=t=++t%2}}():Y?function(){var t=new MessageChannel;return t.port1.onmessage=r,function(){return t.port2.postMessage(0)}}():void 0===U&&"function"==typeof i?function(){try{var t=Function("return this")().require("vertx");return z=t.runOnLoop||t.runOnContext,o()}catch(t){return a()}}():a();var J=Math.random().toString(36).substring(2),X=void 0,Q=1,$=2,tt={error:null},it=0,et=function(){function t(t,i){this._instanceConstructor=t,this.promise=new t(d),this.promise[J]||A(this.promise),E(i)?(this.length=i.length,this._remaining=i.length,this._result=new Array(this.length),0===this.length?b(this.promise,this._result):(this.length=this.length||0,this._enumerate(i),0===this._remaining&&b(this.promise,this._result))):w(this.promise,G())}return t.prototype._enumerate=function(t){for(var i=0;this._state===X&&i<t.length;i++)this._eachEntry(t[i],i)},t.prototype._eachEntry=function(t,i){var e=this._instanceConstructor,s=e.resolve;if(s===u){var n=f(t);if(n===h&&t._state!==X)this._settledAt(t._state,i,t._result);else if("function"!=typeof n)this._remaining--,this._result[i]=t;else if(e===st){var o=new e(d);m(o,t,n),this._willSettleAt(o,i)}else this._willSettleAt(new e(function(i){return i(t)}),i)}else this._willSettleAt(s(t),i)},t.prototype._settledAt=function(t,i,e){var s=this.promise;s._state===X&&(this._remaining--,t===$?w(s,e):this._result[i]=e),0===this._remaining&&b(s,this._result)},t.prototype._willSettleAt=function(t,i){var e=this;x(t,void 0,function(t){return e._settledAt(Q,i,t)},function(t){return e._settledAt($,i,t)})},t}(),st=function(){function t(i){this[J]=P(),this._result=this._state=void 0,this._subscribers=[],d!==i&&("function"!=typeof i&&C(),this instanceof t?F(this,i):H())}return t.prototype.catch=function(t){return this.then(null,t)},t.prototype.finally=function(t){var i=this,s=i.constructor;return e(t)?i.then(function(i){return s.resolve(t()).then(function(){return i})},function(i){return s.resolve(t()).then(function(){throw i})}):i.then(t,t)},t}();return st.prototype.then=h,st.all=R,st.race=O,st.resolve=u,st.reject=D,st._setScheduler=s,st._setAsap=n,st._asap=V,st.polyfill=I,st.Promise=st,st})})),v=(m.polyfill(),"en"),S=["en","de","es","fr","el","it","zh"],b={en:"Loading...",de:"Lade...",es:"Cargando...",fr:"Chargement...",el:"\u03A6\u03CC\u03C1\u03C4\u03C9\u03C3\u03B7...",it:"Caricamento in corso...",zh:"\u6B63\u5728\u5BFC\u5165"},w={en:"Game Over",de:"Game Over",es:"Game Over",fr:"Game Over",el:"Game Over",it:"Game Over",zh:"\u6E38\u620F\u7ED3\u675F"},x={en:"New\nGame",de:"Neues\nSpiel",es:"Nuevo\nJuego",fr:"Nouveau\njeu",el:"\u039A\u03B1\u03B9\u03BD\u03BF\u03CD\u03C1\u03B9\u03BF\n\u03C0\u03B1\u03B9\u03C7\u03BD\u03AF\u03B4\u03B9",it:"Nuovo\nGioco",zh:"\u65B0\u7684\u6E38\u620F"},T={en:"Play",de:"Spielen",es:"Jugar",fr:"Jouer",el:"\u03A0\u03B1\u03AF\u03BE\u03B5",it:"Gioca",zh:"\u5F00\u59CB"},k={en:"Play\nAgain",de:"Nochmal",es:"De Nuevo",fr:"Rejouer",el:"\u03A0\u03B1\u03AF\u03BE\u03B5\n\u03BE\u03B1\u03BD\u03AC",it:"Gioca\nAncora",zh:"\u518D\u6765\u4E00\u6B21"},B={en:"Credits",de:"Info",es:"Cr\xE9ditos",fr:"Cr\xE9dits",el:"\u03C0\u03B9\u03C3\u03C4\u03CE\u03C3\u03B5\u03B9\u03C2",it:"Crediti",zh:"\u5B66\u5206"},F={en:"Back",de:"Zur\xFCck",es:"Regresar",fr:"Retourner",el:"\u0395\u03C0\u03B9\u03C3\u03C4\u03C1\u03BF\u03C6\u03AE",it:"Indietro",zh:"\u8FD4\u56DE"},P={en:"Island",de:"Insel",es:"Isla",fr:"\xEEle",el:"\u03BD\u03B7\u03C3\u03AF",it:"Isola",zh:"\u5C9B"},A=[1,2,3],G="assets/";!function(t){t[t.BGFixed=0]="BGFixed",t[t.BGMountains=1]="BGMountains",t[t.BGClouds=2]="BGClouds",t[t.BGSunReflections=3]="BGSunReflections",t[t.BGSeaSurface=4]="BGSeaSurface",t[t.BGIslandSignText=5]="BGIslandSignText",t[t.BGSeaFloor=6]="BGSeaFloor",t[t.BGSeaBackRocks=7]="BGSeaBackRocks",t[t.BGSeaStuff=8]="BGSeaStuff",t[t.Puffin=9]="Puffin",t[t.UI=10]="UI",t[t.DeadFlies=11]="DeadFlies",t[t.DeadSandeels=12]="DeadSandeels",t[t.Splashes=13]="Splashes",t[t.Waves=14]="Waves",t[t.Seagulls=15]="Seagulls",t[t.Flies=16]="Flies",t[t.Sharks=17]="Sharks"}(_||(_={}));for(var R=["eel","fly","shark","puffin","seagull","waves","splash","static","ui","bg"],O="permanent-marker",D="font",C="font-down",H={puffin:[100,57,30,30],seagull:[20,20,60,19],shark:[20,4,90,30],fly:[7,7,23,20]},I=[4,8,12,10],L=[7,7,10,14],E=["blue","green","yellow"],M=["blue","green"],z=0,W=[1,2];z<W.length;z++)for(var V=W[z],U=0,j=E;U<j.length;U++){var N=j[U];H["eel/"+N+"/"+V]=I}for(var K=0,Y=E;K<Y.length;K++){var N=Y[K];H["eel/"+N+"/3"]=L}var Z,q,J,X,Q,$,tt,it,et=function(){function i(t){this._game=t,this._sprites={},this._groups={},this.DPR=d,this.fixedScale=l,this.dynamicScale=p,this._imgPath=G+"img@"+this.fixedScale+"x/",this._fontPath=G+"font@"+this.fixedScale+"x/"}return i.prototype.preloadGameAssets=function(){if(!this._gameAssetsPreloaded){this._gameAssetsPreloaded=!0,this._game.load.path=this._imgPath;for(var t=0,i=R;t<i.length;t++){var e=i[t];"ui"!==e&&"bg"!==e&&this._game.load.atlas(e)}}},i.prototype.preloadUIAssets=function(){if(!this._uiAssetsPreloaded){if(this._uiAssetsPreloaded=!0,this._game.load.path=this._imgPath,this._game.load.atlas("ui").atlas("bg"),this._game.load.path=this._fontPath,"zh"===v||"el"===v){var t="zh"===v?"noto-sans-chinese":"chalkboard-se-greek";D="font-numbers",C="font-numbers-down",this._game.load.bitmapFont(D,O+".png",O+".json").bitmapFont(C,O+"-down.png",O+"-down.json").bitmapFont("font",t+".png",t+".json").bitmapFont("font-down",t+"-down.png",t+"-down.json")}else this._game.load.bitmapFont("font",O+".png",O+".json").bitmapFont("font-down",O+"-down.png",O+"-down.json");this._game.load.bitmapFont("font-white","permanent-marker-white.png","permanent-marker-white.json")}},i.prototype.getSize=function(t){var i=this._game.cache.getFrameByName(o(t),t);return{h:i.sourceSizeH*this.dynamicScale,w:i.sourceSizeW*this.dynamicScale}},i.prototype.getFirstDead=function(t,i,e,s,n){var a=void 0!==n?"/"+n:"",r=t.getFirstDead(!0,i,e,o(s),s+a);return this._setupSprite(r,s),r},i.prototype.make=function(t,i){var e=void 0!==i?"/"+i:"",s=this._game.make.sprite(0,0,o(t),t+e);return this._setupSprite(s,t),this._sprites[t]=s,s},i.prototype.get=function(t){return this._sprites[t]},i.prototype.addGroup=function(i,e){void 0===e&&(e=!1);var s=this._game.add.group();return s.name=_[i],e&&(s.enableBody=!0,s.physicsBodyType=t.Physics.ARCADE),this._groups[i]=s,s},i.prototype.getGroup=function(t){return this._groups[t]},i.prototype.add=function(t,i,e,s,n){var a=void 0!==n?"/"+n:"",r=this._game.add.sprite(t,i,o(e),e+a,s);return this._setupSprite(r,e),r},i.prototype.addButton=function(t,i,e,s,n,a){var r=this._game.add.button(t,i,o(e),n,a,null,e,s,s?e:null);return r.fixedToCamera=!0,r.scale.set(this.dynamicScale),r},i.prototype.addAnimation=function(i,e,s,n,o){void 0===o&&(o=!0);var a=i.animations.getAnimation(e);if(a)return a;var r=t.Animation.generateFrameNames(e+"/",1,s);return i.animations.add(e,r,n,o)},i.prototype.renderBodies=function(t){var i=this;t.forEachAlive(function(t){i._game.debug.body(t)},null)},i.prototype._setupSprite=function(t,i){t.scale.set(this.dynamicScale);var e=o(i),s=H[i]||H[e];if(s){this._game.physics.arcade.enable(t);var n=t.body,a=this.fixedScale;n.setSize(s[2]*a,s[3]*a,s[0]*a,s[1]*a)}},i.prototype.setupBackgroundSprite=function(t){t.anchor.x=.5,t.anchor.y=1;var i=t.width/t.height;i<this._game.width/this._game.height?(t.width=this._game.width,t.height=t.width/i):(t.height=this._game.height,t.width=t.height*i)},i}(),st=function(){function t(){}return t.S="S",t.M="M",t.L="L",t}(),nt={M:400,L:800},ot={gravity:600,acceleration:0,drag:10,initialVelocity:100,maxVelocity:1e4,tapVelocity:(Z={},Z[st.S]=-150,Z[st.M]=-130,Z[st.L]=-110,Z),topBumpVelocity:30,oxygenDelta:.1,maxAngle:10,deltaAngle:1,angleTweenDuration:100},at={velocityFactor:.5,gravity:(q={},q[st.S]=-300,q[st.M]=-400,q[st.L]=-500,q),acceleration:0,drag:50,maxVelocity:300,tapVelocity:100,topBumpVelocity:-30,oxygenDelta:-.1,minAngle:-10,deltaAngle:1,angleTweenDuration:400},rt={Sandeel:(J={},J.yellow=150,J.blue=40,J.green=80,J),Fly:5,Seagull:-30,SeagullKamikaze:-200,IslandReachedBonus:1e3},ht=/android/i.test(navigator.userAgent),ut=/iP[ao]d|iPhone/i.test(navigator.userAgent),dt="."+(ht?"ogg":"m4a"),lt=function(){function t(t,i){this.game=t,this.sprites=i}return t.prototype.addOnDownHandler=function(t,i){t.events.onInputDown.add(function(){return i.font="font-down"}),t.events.onInputUp.add(function(){return i.font="font"})},t.prototype.addSignPost=function(t,i,e,s){this.buttonStick=this.sprites.add(.7*this.game.width,.97*this.game.height,"ui/sign-base"),this.buttonStick.anchor.x=.5,this.buttonStick.anchor.y=1;var n=this.buttonStick.height,o=this.buttonStick.y-n,a=e?o+.05*n:o+.2*n;this.buttonRight=this.sprites.addButton(this.buttonStick.x,a,"ui/sign-right",null,i,null),this.buttonRight.anchor.x=.4;var r="zh"===v?3:5,h=(t.length<=r?30:22)*f;if(this.buttonRightText=this.game.add.bitmapText(this.buttonRight.x,this.buttonRight.y+this.buttonRight.height/2,"font",t,h),this.buttonRightText.fixedToCamera=!0,this.buttonRightText.anchor.x=this.buttonRight.anchor.x+.05,this.buttonRightText.anchor.y=.5,this.addOnDownHandler(this.buttonRight,this.buttonRightText),e){this.buttonLeft=this.sprites.addButton(this.buttonStick.x,o+.51*n,"ui/sign-left",null,s,null),this.buttonLeft.anchor.x=.65;var u=16*f;this.buttonLeftText=this.game.add.bitmapText(this.buttonLeft.x,this.buttonLeft.y+this.buttonLeft.height/2,"font",e,u),this.buttonLeftText.fixedToCamera=!0,this.buttonLeftText.anchor.x=this.buttonLeft.anchor.x,this.buttonLeftText.anchor.y=.5,this.addOnDownHandler(this.buttonLeft,this.buttonLeftText)}},t.prototype.addLeftTopSign=function(t,i){var e=this.sprites.getSize("ui/sign-right"),s=e.w,n=e.h;this.buttonLeftTop=this.sprites.addButton(.05*this.game.width+s/2,this.buttonLeft.top-.7*n,"ui/sign-right",null,i,null),this.buttonLeftTop.angle=180,this.buttonLeftTop.anchor.x=this.buttonLeftTop.anchor.y=.5;var o=22*f;this.buttonLeftTopText=this.game.add.bitmapText(this.buttonLeftTop.x,this.buttonLeftTop.y,"font",t,o),this.buttonLeftTopText.anchor.y=.5,this.buttonLeftTopText.anchor.x=.3,this.buttonLeftTopText.fixedToCamera=!0,this.addOnDownHandler(this.buttonLeftTop,this.buttonLeftTopText)},t.prototype.addLeftSign=function(t,i){var e=this.sprites.getSize("ui/sign-right"),s=e.w,n=e.h;this.buttonLeft=this.sprites.addButton(.05*this.game.width+s/2,.95*this.game.height-n/2,"ui/sign-right",null,i,null),this.buttonLeft.angle=180,this.buttonLeft.anchor.x=this.buttonLeft.anchor.y=.5;var o=22*f;this.buttonLeftText=this.game.add.bitmapText(this.buttonLeft.x,this.buttonLeft.y,"font",t,o),this.buttonLeftText.anchor.y=.5,this.buttonLeftText.anchor.x=.3,this.buttonLeftText.fixedToCamera=!0,this.addOnDownHandler(this.buttonLeft,this.buttonLeftText)},t.prototype.addRightSign=function(t,i){var e=this.sprites.getSize("ui/sign-right"),s=e.w,n=e.h;this.buttonRight=this.sprites.addButton(.95*this.game.width-s/2,.95*this.game.height-n/2,"ui/sign-right",null,i,null),this.buttonRight.anchor.x=this.buttonRight.anchor.y=.5;var o=22*f;this.buttonRightText=this.game.add.bitmapText(this.buttonRight.left+.13*s,this.buttonRight.y,"font",t,o),this.buttonRightText.anchor.y=.5,this.buttonRightText.anchor.x=0,this.buttonRightText.fixedToCamera=!0,this.addOnDownHandler(this.buttonRight,this.buttonRightText)},t.prototype.destroy=function(){this.buttonStick&&this.buttonStick.destroy(),this.buttonRight&&(this.buttonRight.destroy(),this.buttonRightText.destroy()),this.buttonLeft&&(this.buttonLeft.destroy(),this.buttonLeftText.destroy()),this.buttonLeftTop&&(this.buttonLeftTop.destroy(),this.buttonLeftTopText.destroy())},t}(),pt=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return s(i,t),i}(t.State),ft=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return s(i,t),i.prototype.init=function(t){this._bg=t,this._sign=new lt(this.game,this.sprites)},i.prototype.create=function(){var t=this;this._buttonSounds=[this.add.sound("button1"),this.add.sound("button2")],this._bg||(this._bg=this.sprites.add(this.game.width/2,this.game.height,"bg/cover"),this.sprites.setupBackgroundSprite(this._bg));this._hungryText=this.game.add.bitmapText(this.game.width/2,.05*this.game.height,"font-white","Hungry",70*f),this._puffinText=this.game.add.bitmapText(this.game.width/2,this._hungryText.bottom,"font-white","Puffin",70*f),this._hungryText.anchor.x=.6,this._puffinText.anchor.x=.35,this._sign.addSignPost(n(x),function(){return t._actionOnClick("Interim")},n(B),function(){return t._actionOnClick("Credits")})},i.prototype._actionOnClick=function(t){this.rnd.pick(this._buttonSounds).play(),this._sign.destroy(),this._hungryText.destroy(),this._puffinText.destroy(),this.game.state.start(t,!1,!1,this._bg),delete this._bg},i}(pt),ct=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return s(i,t),i.prototype.init=function(t){this._bg=t,this._sign=new lt(this.game,this.sprites)},i.prototype.create=function(){var t=this;this._buttonSounds=[this.add.sound("button1"),this.add.sound("button2")],this._bg||(this._bg=this.sprites.add(this.game.width/2,this.game.height,"bg/cover"),this.sprites.setupBackgroundSprite(this._bg));var i=.5*this.game.width;this._scroll=this.sprites.add(i,30*f,"ui/scroll");var e=Math.min(g-.65,1);this._scroll.scale.multiply(e,e);var s=this._scroll;this._poweredByText=this.add.bitmapText(i,s.y+.24*s.height,D,"Powered by",25*f*e),this._phaserText=this.add.bitmapText(i,s.y+.41*s.height,D,"Phaser CE",35*f*e),this._githubText=this.add.bitmapText(i,s.y+.68*s.height,D,"GitHub:",15*f*e),this._githubURLText=this.add.bitmapText(i,s.y+.75*s.height,D,"letmaik/hungrypuffin",15*f*e),this._githubText.inputEnabled=this._githubURLText.inputEnabled=this._phaserText.inputEnabled=!0,this._githubText.events.onInputDown.add(this._onGithubDown,this),this._githubURLText.events.onInputDown.add(this._onGithubDown,this),this._githubText.events.onInputUp.add(this._onGithubUp,this),this._githubURLText.events.onInputUp.add(this._onGithubUp,this),this._phaserText.events.onInputDown.add(this._onPhaserDown,this),this._phaserText.events.onInputUp.add(this._onPhaserUp,this),s.anchor.x=this._scroll.anchor.x=this._poweredByText.anchor.x=this._phaserText.anchor.x=this._githubText.anchor.x=this._githubURLText.anchor.x=.5,this._sign.addSignPost(n(F),function(){return t._actionOnClick("StartMenu")})},i.prototype._onGithubDown=function(){this._githubText.font=C,this._githubURLText.font=C},i.prototype._onGithubUp=function(){this._githubText.font=D,this._githubURLText.font=D,window.open("https://github.com/letmaik/hungrypuffin","_blank")},i.prototype._onPhaserDown=function(){this._phaserText.font=C},i.prototype._onPhaserUp=function(){this._phaserText.font=D,window.open("https://phaser.io","_blank")},i.prototype._actionOnClick=function(t){this.rnd.pick(this._buttonSounds).play(),this._sign.destroy(),this._scroll.destroy(),this._phaserText.destroy(),this._poweredByText.destroy(),this._githubText.destroy(),this._githubURLText.destroy(),this.game.state.start(t,!1,!1,this._bg),delete this._bg},i}(pt),gt=function(i){function e(){var t=null!==i&&i.apply(this,arguments)||this;return t._firstInit=!0,t}return s(e,i),e.prototype.init=function(t){this._sign=null,this._bg=t,this.loadingDone=!1,this.preloadTimeReached=!1},e.prototype.preload=function(){var i=this;this._preloadStart=this.time.now,this._bg||(this._bg=this.sprites.add(this.game.width/2,this.game.height,"bg/cover"),this.sprites.setupBackgroundSprite(this._bg));var e=this.sprites.getSize("ui/loading-bar-empty"),s=.75*this.game.height,o=this.add.bitmapText(this.game.width/2,s+e.h+5*f,"font",n(b),20*f);o.anchor.x=.5;var a=this.sprites.add((this.game.width-e.w)/2,s,"ui/loading-bar-empty"),r=this.sprites.add(a.x,a.y,"ui/loading-bar-full");this.loadingBarEmpty=a,this.loadingBarFull=r,this.loadingText=o,r.crop(new t.Rectangle(0,0,0,a.height/this.sprites.dynamicScale),!1),this.add.tween(r.cropRect).to({width:e.w/this.sprites.dynamicScale},3e3,null,!0).onUpdateCallback(function(){return r.updateCrop()}).onComplete.add(function(){i.preloadTimeReached=!0,i.hideLoadingBarAndDisplayButton()},this),this.sprites.preloadGameAssets(),this.load.path="assets/audio/",this.load.audio("splash","splash"+dt).audio("food_reward","food_reward"+dt).audio("yellow_sandeel","yellow_sandeel"+dt).audio("kamikaze_seagull","kamikaze_seagull"+dt).audio("puffin_dies_hit_by_shark","puffin_hit_by_shark"+dt).audio("puffin_hit_by_seagull","puffin_hit_by_seagull"+dt).audio("game_win","game_win"+dt).audio("game_music","game_music"+dt)},e.prototype.hideLoadingBarAndDisplayButton=function(){this.loadingDone&&this.loadingBarEmpty&&(this.loadingBarEmpty.destroy(),this.loadingBarFull.destroy(),this.loadingText.destroy(),this._addButton(),this.loadingBarEmpty=this.loadingBarFull=this.loadingText=null)},e.prototype.create=function(){this._buttonSounds=[this.add.sound("button1"),this.add.sound("button2")],this._firstInit&&(this._firstInit=!1,this.sprites.addGroup(_.BGFixed),this.sprites.addGroup(_.BGClouds,!0),this.sprites.addGroup(_.BGMountains,!0),this.sprites.addGroup(_.BGSunReflections,!0),this.sprites.addGroup(_.BGSeaSurface,!0),this.sprites.addGroup(_.BGIslandSignText,!0),this.sprites.addGroup(_.BGSeaBackRocks,!0),this.sprites.addGroup(_.BGSeaFloor,!0),this.sprites.addGroup(_.BGSeaStuff,!0),this.sprites.addGroup(_.DeadFlies).fixedToCamera=!0,this.sprites.addGroup(_.DeadSandeels).fixedToCamera=!0,this.sprites.addGroup(_.Splashes),this.sprites.addGroup(_.Waves,!0),this.sprites.addGroup(_.Seagulls,!0),this.sprites.addGroup(_.Flies,!0),this.sprites.addGroup(_.Sharks,!0),this.sprites.addGroup(_.Puffin,!0),this.sprites.addGroup(_.UI),this._makePuffin(),this._makeSplash(),this.game.renderer.setTexturePriority(R)),this.loadingDone=!0,this.preloadTimeReached&&this.hideLoadingBarAndDisplayButton()},e.prototype._makePuffin=function(){var i=["S","M","L"],e=["float","float-blink","float2swim","float2vomit","fly","fly-blink","fly2float","fly2vomit","swim","swim-blink","vomit"],s=this.sprites.make("puffin/S/float",0);s.anchor=new t.Point(.5,.5);for(var n=0,o=i;n<o.length;n++)for(var a=o[n],r=0,h=e;r<h.length;r++){var u=h[r];this.sprites.addAnimation(s,"puffin/"+a+"/"+u,function(t){return-1!==t.indexOf("2")?5:"vomit"===t?30:10}(u),"vomit"===u?30:20,function(t){return-1!==["float","fly","swim"].indexOf(t)}(u))}},e.prototype._makeSplash=function(){var t=this.sprites.make("splash",1);t.anchor.x=.5,t.anchor.y=1;var i=this.sprites.addAnimation(t,"splash",9,40,!1);t.animations.currentAnim=i,i.killOnComplete=!0,i.play()},e.prototype._addButton=function(){var t=this;this._sign=new lt(this.game,this.sprites),this._sign.addSignPost(n(T),function(){return t._actionOnClick("Play")})},e.prototype._actionOnClick=function(t){this.rnd.pick(this._buttonSounds).play(),this._sign.destroy(),this._bg.destroy(),delete this._bg,this.game.state.start(t,!1,!1)},e}(pt),_t={},yt=new t.Point(.5,.5),mt=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return s(i,t),i.prototype.init=function(t){this._camPos=t,this._sign=new lt(this.game,this.sprites)},i.prototype.preload=function(){this.camera.setPosition(this._camPos.x,this._camPos.y)},i.prototype.create=function(){var t=this;this._buttonSounds=[this.add.sound("button1"),this.add.sound("button2")],this._signHanging=this.sprites.add(this.game.width/2,.1*this.game.height,"ui/sign-hanging"),this._signHanging.fixedToCamera=!0,this._signHanging.anchor.x=yt.x;var i="zh"===v?"font":D,e=40*f,s=n(w),o=this.add.bitmapText(.5*this.game.width,this._signHanging.y+.4*this._signHanging.height,i,s,e);o.anchor=yt.clone(),o.fixedToCamera=!0,this._gameOverText=o;var a=60*f,r=X.toString(),h=this.add.bitmapText(.5*this.game.width,this._signHanging.y+.7*this._signHanging.height,D,r,a);h.anchor=yt.clone(),h.fixedToCamera=!0,this._scoreText=h,this._sign.addRightSign(n(k),function(){return t._onPlayButtonClick()})},i.prototype._onPlayButtonClick=function(){this.rnd.pick(this._buttonSounds).play(),this.game.state.start("Play",!1,!1),this._removeUI()},i.prototype._removeUI=function(){this._sign.destroy(),this._signHanging.destroy(),this._scoreText.destroy(),this._gameOverText.destroy()},i}(pt),vt=Math.PI/180,St=function(){function i(t,i,e,s){this.game=t,this.play=i,this.sprites=e,this.spawnRange=s}return i.prototype.init=function(){this.group=this.sprites.getGroup(_.Sharks)},i.prototype.create=function(){this.jumpingShark=!1,this.stopSpawning=!1,this.velocityFactor=1,this.game.time.events.add(2400,this.addShark,this)},i.prototype.overlap=function(t,i,e){this.game.physics.arcade.overlap(t,this.group,i,null,e)},i.prototype.addShark=function(){if(!this.stopSpawning){var i=1200/this.velocityFactor,e=1.5*i,s=this.game.rnd.between(0,e);if(this.game.time.events.add(i+s,this.addShark,this),t.Utils.chanceRoll(10)&&this.play._playTimeRatio>.7){this.jumpingShark=!0;var n=this.game.width,o=1.1*this.play._skyHeight,a=this.sprites.getFirstDead(this.group,n,o,"shark",1)
;a.anchor=kt.clone(),a.rotation=20*vt;var r=a.width;a.x+=r/2;var h=this.game.add.tween(a).to({y:o,rotation:-20*vt},750,t.Easing.Sinusoidal.In);h.onComplete.addOnce(this._killFlyingShark,this.play),this.game.add.tween(a).to({y:.85*o,rotation:0},750,t.Easing.Sinusoidal.Out,!0).chain(h),this.game.add.tween(a).to({x:-r/2},1500,t.Easing.Linear.None,!0)}else{var u=300*c*this.velocityFactor,n=this.game.width,d=this.spawnRange,l=d.top,p=d.bottom,o=this.game.rnd.integerInRange(l,p),a=this.sprites.getFirstDead(this.group,n,o,"shark",1);this.sprites.addAnimation(a,"shark",50,60).play(),a.rotation=0,a.anchor.x=0,a.anchor.y=.5,a.lifespan=(n+a.width)/u*1e3;a.body.velocity.x=-u}}},i.prototype._killFlyingShark=function(t){t.kill(),this.jumpingShark=!1},i}(),bt=function(){function t(t,i,e){this.game=t,this.sprites=i,this.spawnRange=e}return t.prototype.init=function(){this.group=this.sprites.getGroup(_.Flies)},t.prototype.create=function(){this.velocityFactor=1,this.stopSpawning=!1,this.addFly(),this.game.time.events.add(1500,this.addFly,this),this.game.time.events.add(3e3,this.addFly,this)},t.prototype.overlap=function(t,i,e){this.game.physics.arcade.overlap(t,this.group,i,null,e)},t.prototype.addFly=function(){if(!this.stopSpawning){var t=3e3/this.velocityFactor,i=.4*t,e=this.game.rnd.between(-i,i);this.game.time.events.add(t+e,this.addFly,this);var s=150*c*this.velocityFactor,n=this.game.width,o=this.spawnRange,a=o.top,r=o.bottom,h=this.game.rnd.integerInRange(a,r),u=this.sprites.getFirstDead(this.group,n,h,"fly",1);this.sprites.addAnimation(u,"fly",41,40).play(),u.anchor.y=.5,u.lifespan=(n+u.width)/s*1e3;u.body.velocity.x=-s}},t}(),wt={1:.69,2:.77,3:.77,4:.69,5:.75},xt={1:.91,2:.79,3:.74,4:.75,5:.77},Tt=function(){function i(t,i,e,s){this.game=t,this.sprites=i,this.skyHeight=e,this.waterHeight=s,this.firstCreate=!0}return i.prototype.init=function(){this.groupFixed=this.sprites.getGroup(_.BGFixed),this.groupClouds=this.sprites.getGroup(_.BGClouds),this.groupMountains=this.sprites.getGroup(_.BGMountains),this.groupSunReflections=this.sprites.getGroup(_.BGSunReflections),this.groupIslandSignText=this.sprites.getGroup(_.BGIslandSignText),this.groupSeaSurface=this.sprites.getGroup(_.BGSeaSurface),this.groupSeaFloor=this.sprites.getGroup(_.BGSeaFloor),this.groupSeaBackRocks=this.sprites.getGroup(_.BGSeaBackRocks),this.groupSeaStuff=this.sprites.getGroup(_.BGSeaStuff),this.groupWaves=this.sprites.getGroup(_.Waves),this.groupsDynamic=[this.groupClouds,this.groupMountains,this.groupSunReflections,this.groupSeaSurface,this.groupIslandSignText,this.groupSeaFloor,this.groupSeaBackRocks,this.groupSeaStuff,this.groupWaves];var t=n(P),i=t.length<=3?40:30;this.islandSignText=this.game.add.bitmapText(0,0,"font",t,.5*i*f,this.groupIslandSignText),this.game.physics.arcade.enable(this.islandSignText),this.islandSignText.visible=!1,this.islandSignText.anchor.y=.5,this.islandSignText.anchor.x=.6},i.prototype.preCreate=function(){this.firstCreate&&(this.addFixedParts(),this.firstCreate=!1),this.velocityFactor=1,this.coast=null,this.stopSpawning=!1,this.lastIslandSignTime=-1/0},i.prototype.create=function(){this.preCreate(),this.addMovingParts()},i.prototype.update=function(){if(this.firstWave.x<-this.waveWidth){var t=this.firstWave,i=this.lastWave;this.firstWave=t.data,this.lastWave=t,t.x=i.x+this.waveWidth,i.data=t}if(this.firstSeafloor.x<-this.seafloorWidth){var t=this.firstSeafloor,i=this.lastSeafloor;this.firstSeafloor=t.data,this.lastSeafloor=t,t.x=i.x+this.seafloorWidth,i.data=t}},i.prototype.addFixedParts=function(){this.game.stage.backgroundColor=7593964,this.sprites.add(this.game.width/2,0,"static/sky",this.groupFixed).anchor.x=.5;var t=this.sprites.add(.15*this.game.width,.15*this.game.width,"static/sun",this.groupFixed);t.anchor.x=t.anchor.y=.5;var i=this.sprites.add(this.game.width/2,this.skyHeight,"static/sea-top",this.groupFixed);i.anchor.x=.5,i.anchor.y=1,this.seaTopHeight=i.height;var e=this.sprites.add(this.game.width/2,this.skyHeight,"static/sea-bottom",this.groupFixed);e.anchor.x=.5,this.seaBottomHeight=e.height,this.game.add.graphics(0,this.skyHeight+e.height,this.groupFixed).beginFill(9605723).drawRect(0,0,this.game.width,this.waterHeight-e.height).endFill()},i.prototype.addMovingParts=function(){this.addInitialMountains(),this.addInitialIslandsAndRocks(),this.addInitialClouds(),this.addInitialBackRocksOrDebris(),this.addInitialSeaStuff(),this.addWaves(),this.addSeaFloor(),this.game.time.events.add(2500,this.addMountain,this),this.game.time.events.add(8e3,this.addCloud,this),this.game.time.events.add(6e3,this.addIslandOrRock,this),this.game.time.events.add(5e3,this.addBackRockOrDebris,this),this.game.time.events.add(1e3,this.addSeaStuff,this)},i.prototype.addWaves=function(){var t=this,i=this.skyHeight,e=this.sprites.getSize("waves/1").w;this.waveWidth=e;var s=function(e){var s=t.sprites.add(e,i,"waves",t.groupWaves,1);return t.sprites.addAnimation(s,"waves",30,30).play(),s.anchor.y=.5,s.body.velocity.x=-40*c*t.velocityFactor,s};this.firstWave=s(0);for(var n=this.firstWave,o=1,a=e;a<this.game.width+e;o++,a+=e){var r=s(a);n.data=r,n=r}this.lastWave=n},i.prototype.addSeaFloor=function(){var t=this,i=this.skyHeight+this.seaBottomHeight,e=this.sprites.getSize("static/sea-floor-1").w;this.seafloorWidth=e;var s=function(e,s){var n=t.sprites.add(s,i,"static/sea-floor-"+e,t.groupSeaFloor);return n.anchor.y=.05,n.body.velocity.x=-t.underwaterSpeed,n};this.firstSeafloor=s(1,0);for(var n=this.firstSeafloor,o=1,a=e;a<this.game.width+e;o++,a+=e){var r=s(1+o%3,a);n.data=r,n=r}this.lastSeafloor=n},i.prototype.addInitialIslandsAndRocks=function(){for(var t=240*f,i=0;i<this.game.width;i+=t)this.addIslandOrRock(i)},i.prototype.addIslandOrRock=function(i){if(!this.coast){var e=6e3/this.velocityFactor,s=.4*e,n=this.game.rnd.between(-s,s);void 0!==i||(this.game.time.events.add(e+n,this.addIslandOrRock,this),i=this.game.width);var o=t.Utils.chanceRoll(50),a=this.game.rnd.between(1,5),r=o?wt[a]:xt[a],h=o?"island":"rock",u=this.skyHeight-.9*this.seaTopHeight,d=.95*this.skyHeight,l=this.game.rnd.between(u,d),p=this.sprites.getFirstDead(this.groupSeaSurface,i,l,"static/"+h+"-"+a);p.anchor.y=r;var f=(l-u)/(d-u),c=this.backSpeed+f*(this.frontSpeed-this.backSpeed);p.lifespan=this.lifespan(i,p.width,c),p.body.velocity.x=-c,o&&this.game.time.now-this.lastIslandSignTime>6e4&&(this.lastIslandSignTime=this.game.time.now,this.addIslandSign(p,c)),this.groupSeaSurface.sort("y",t.Group.SORT_ASCENDING)}},i.prototype.addIslandSign=function(t,i){var e=t.x+t.width/2,s=t.y+1,n=this.sprites.getFirstDead(this.groupSeaSurface,e,s,"ui/sign-base");n.scale.multiply(.5,.5),n.anchor.y=1.08;var o=this.sprites.getFirstDead(this.groupSeaSurface,e-20*f,s,"ui/sign-right");o.scale.multiply(.5,.5),o.anchor.y=2.1;var a=this.islandSignText;a.x=o.left+o.width/2,a.y=o.top+o.height/2,a.revive(),o.lifespan=n.lifespan=a.lifespan=t.lifespan,o.body.velocity.x=n.body.velocity.x=a.body.velocity.x=-i},i.prototype.addInitialBackRocksOrDebris=function(){for(var t=150*f,i=0;i<this.game.width;i+=t)this.addBackRockOrDebris(i)},i.prototype.addBackRockOrDebris=function(t){if(!this.coast){var i=5e3/this.velocityFactor,e=.4*i,s=this.game.rnd.between(-e,e);void 0===t&&(this.game.time.events.add(i+s,this.addBackRockOrDebris,this),t=this.game.width);var n={"back-rock":3,"back-debris":2},o=Object.keys(n),a=this.game.rnd.pick(o),r=this.game.rnd.between(1,n[a]),h=this.skyHeight+1.02*this.seaBottomHeight,u=this.sprites.getFirstDead(this.groupSeaBackRocks,t,h,"static/"+a+"-"+r);u.anchor.y=1,u.lifespan=this.lifespan(t,u.width,this.underwaterSpeed),u.body.velocity.x=-this.underwaterSpeed}},i.prototype.addInitialSeaStuff=function(){for(var t=30*f,i=0;i<this.game.width;i+=t)this.addSeaStuff(i)},i.prototype.addSeaStuff=function(i){if(!this.coast){var e=1e3/this.velocityFactor,s=.4*e,n=this.game.rnd.between(-s,s);void 0===i&&(this.game.time.events.add(e+n,this.addSeaStuff,this),i=this.game.width);var o={"sea-rock":3,debris:4,seaweed:4,coral:5},a=Object.keys(o),r=this.game.rnd.pick(a),h=this.game.rnd.between(1,o[r]),u=this.skyHeight+this.seaBottomHeight+Math.random()*(this.waterHeight-this.seaBottomHeight)*.4,d=this.sprites.getFirstDead(this.groupSeaStuff,i,u,"static/"+r+"-"+h);d.anchor.y=1,d.lifespan=this.lifespan(i,d.width,this.backSpeed),d.body.velocity.x=-this.underwaterSpeed,this.groupSeaStuff.sort("y",t.Group.SORT_ASCENDING)}},i.prototype.addInitialMountains=function(){for(var t=50*f,i=-40*f;i<this.game.width+40*f;i+=t){var e=this.game.rnd.between(-40,40);this.addMountain(i+e*f)}},i.prototype.addMountain=function(t){if(!this.stopSpawning){var i=2500/this.velocityFactor,e=.4*i,s=this.game.rnd.between(0,e);void 0===t&&(this.game.time.events.add(i+s,this.addMountain,this),t=this.game.width);var n=this.game.rnd.between(1,7),o=this.skyHeight-this.seaTopHeight+5*f,a=this.sprites.getFirstDead(this.groupMountains,t,o,"static/mountain-"+n);a.anchor.y=1,a.lifespan=this.lifespan(t,a.width,this.backSpeed),a.body.velocity.x=-this.backSpeed}},i.prototype.addInitialClouds=function(){for(var t=160*f,i=-100*f;i<this.game.width+100*f;i+=t){var e=this.game.rnd.between(-100,100);this.addCloud(i+e*f)}},i.prototype.addCloud=function(t){if(!this.stopSpawning){var i=8e3/this.velocityFactor,e=.4*i,s=this.game.rnd.between(0,e);void 0===t&&(this.game.time.events.add(i+s,this.addCloud,this),t=this.game.width);var n=this.game.rnd.between(1,5),o=this.game.rnd.between(.2*this.skyHeight,.7*this.skyHeight),a=this.sprites.getFirstDead(this.groupClouds,t,o,"static/cloud-"+n);a.anchor.y=1;var r=this.backSpeed+this.game.rnd.between(-5*c,5*c);a.lifespan=this.lifespan(t,a.width,r),a.body.velocity.x=-r}},i.prototype.addCoast=function(){var t=this.sprites.add(this.game.width,this.skyHeight,"static/coast",this.groupSeaStuff);this.groupSeaStuff.sendToBack(t),t.anchor.y=.35,t.body.velocity.x=-this.underwaterSpeed,this.coast=t},i.prototype.lifespan=function(t,i,e){return(t+i)/e*1e3},Object.defineProperty(i.prototype,"frontSpeed",{get:function(){return 40*c*this.velocityFactor},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"backSpeed",{get:function(){return 20*c*this.velocityFactor},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"underwaterSpeed",{get:function(){return 30*c*this.velocityFactor},enumerable:!0,configurable:!0}),i}(),kt=new t.Point(.5,.5);!function(t){t[t.Air=0]="Air",t[t.Water=1]="Water"}(it||(it={}));var Bt;!function(t){t[t.Fly=0]="Fly",t[t.Float=1]="Float",t[t.Vomit=2]="Vomit",t[t.Swim=3]="Swim"}(Bt||(Bt={}));var Ft;!function(t){t[t.Fly2Float=0]="Fly2Float",t[t.Float2Fly=1]="Float2Fly",t[t.Swim2Float=2]="Swim2Float",t[t.Float2Swim=3]="Float2Swim",t[t.Float2Vomit=4]="Float2Vomit",t[t.Fly2Vomit=5]="Fly2Vomit",t[t.Vomit2Float=6]="Vomit2Float"}(Ft||(Ft={}));var Pt=function(i){function e(){var t=null!==i&&i.apply(this,arguments)||this;return t._countSandeelsEaten={},t._firstInit=!0,t._DEBUG=!1,t._musicOn=!0,t}return s(e,i),e.prototype.init=function(){this._firstInit?(this._firstInit=!1,this._doFirstInit()):this._restart(),this._gameDuration=0,this._substance=null,this._puffinSize=st.S,this._previousPuffinState=Bt.Fly,this._puffinState=Bt.Float,this._puffinTransition=null,this._hasSplashed=!1,this._lastTapTime=0,this._points=0,this._oxygen=1,this._oxygenBarVisible=!1,this._sandeelsCollisionGroup=[],this._velocityFactor=1,this._targetVelocityFactor=1,this._velocityModificationActive=!1,this._countFliesEaten=0,this._countSeagullHits=0;for(var t=0,i=E;t<i.length;t++){var e=i[t];this._countSandeelsEaten[e]=0}this._coastReached=!1,this._coastDisplaying=!1,this._coastBonusReceived=!1},e.prototype._doFirstInit=function(){var i,e,s,n=this;this._physicsScale=c,this._timer=this.time.events;var o=this.game.width*(16/9);this._skyHeight=.7*o,this._skyPhysicsHeight=.67*o,this._waterHeight=.65*o,this._totalHeight=this._skyHeight+this._waterHeight,this.world.setBounds(0,0,this.game.width,this._totalHeight),this._background=new Tt(this.game,this.sprites,this._skyHeight,this._waterHeight),this._flies=new bt(this.game,this.sprites,{top:0,bottom:.9*this._skyHeight}),this._sharks=new St(this.game,this,this.sprites,{top:this._skyHeight+.1*this._waterHeight,bottom:this._skyHeight+.9*this._waterHeight}),this._addAudio(),this._seagullHeight=this.sprites.getSize("seagull/1").h,this._uiGroup=this.sprites.getGroup(_.UI),this._deadFliesGroup=this.sprites.getGroup(_.DeadFlies),this._deadSandeelsGroup=this.sprites.getGroup(_.DeadSandeels),this._splashesGroup=this.sprites.getGroup(_.Splashes),this._seagullsGroup=this.sprites.getGroup(_.Seagulls),this._puffinGroup=this.sprites.getGroup(_.Puffin),this._background.init(),this._flies.init(),this._sharks.init(),this._velocityChangingGroups=[this._seagullsGroup,this._sharks.group,this._flies.group],(i=this._velocityChangingGroups).push.apply(i,this._background.groupsDynamic),this._groupsToFreeze=[this._splashesGroup,this._puffinGroup,this._seagullsGroup,this._flies.group,this._sharks.group,this._uiGroup],(e=this._groupsToFreeze).push.apply(e,this._background.groupsDynamic),this._groupsToReset=[this._splashesGroup,this._deadFliesGroup,this._deadSandeelsGroup,this._uiGroup,this._seagullsGroup,this._flies.group,this._sharks.group],(s=this._groupsToReset).push.apply(s,this._background.groupsDynamic),this._timer.add(1700,function(){var t=n._puffin.x,i=n._puffin.top,e=n.sprites.add(t,i,"ui/finger-tap",n._uiGroup);e.anchor.x=.5,e.anchor.y=.4,e.angle=180;var s=n._timer.loop(1,function(){e.y=n._puffin.top}),o=0;n._timer.repeat(130,11,function(){e.visible=!e.visible,11==++o&&(e.destroy(),n._timer.remove(s))})}),this.input.keyboard.addKey(t.Keyboard.D).onDown.add(function(){n.game.debug.reset(),n._DEBUG=!n._DEBUG}),this.input.keyboard.addKey(t.Keyboard.M).onDown.add(function(){n._musicOn=!n._musicOn,n._musicOn?n._backgroundMusic.play():n._backgroundMusic.stop()})},e.prototype._restart=function(){this._timer.start();for(var t=0,i=this._groupsToReset;t<i.length;t++){i[t].forEachAlive(function(t){return t.kill()},null)}},e.prototype._freeze=function(i){void 0===i&&(i=!1),i||this._timer.stop(!0),this.input.onDown.remove(this._onTap,this),this.input.keyboard.addKey(t.Keyboard.SPACEBAR).onDown.remove(this._onTap,this),i||this.tweens.removeAll();for(var e=0,s=this._groupsToFreeze;e<s.length;e++){s[e].forEachAlive(function(t){var e=t.body;if(e&&e.velocity.set(0),t.lifespan=0,!i&&t.animations){var s=t.animations.currentAnim;s&&(s.stop(!1,!1),s.onComplete.removeAll())}},null)}i||(this._puffinBody.gravity.y=0)},e.prototype.create=function(){this._musicOn&&this._backgroundMusic.play(),this._flies.create(),this._sharks.create(),this._background.create(),this._addPuffin(),this._addSplash(),this._createSeagulls(),this._createSandeels(),this._createPointsText(),this._createOxygenBar()},e.prototype._addAudio=function(){this._backgroundMusic=this.add.sound("game_music",1,!0),this._splashSound=this.add.sound("splash"),this._gameWinSound=this.add.sound("game_win"),this._foodRewardSound=this.add.sound("food_reward"),this._yellowSandeelSound=this.add.sound("yellow_sandeel"),this._kamikazeSeagullSound=this.add.sound("kamikaze_seagull"),this._puffinHitBySeagullSound=this.add.sound("puffin_hit_by_seagull"),this._puffinDiesHitBySharkSound=this.add.sound("puffin_dies_hit_by_shark")},Object.defineProperty(e.prototype,"_tapDelta",{get:function(){return this.game.time.now-this._lastTapTime},enumerable:!0,configurable:!0}),e.prototype.update=function(){var t=this;if(0!==this._puffin.health){this._gameDuration+=this.time.physicsElapsedMS*this._velocityFactor,this._gameDuration>24e4&&(this._coastDisplaying?this._background.coast.right<=this.game.width&&(this._coastReached?!this._coastBonusReceived&&this._puffin.right>=.8*this.game.width?(this._coastBonusReceived=!0,this._yellowSandeelSound.play(),this._updatePoints(rt.IslandReachedBonus)):this._puffin.left>=this.game.width?this._die():this._substance===it.Air&&this._puffin.y>this._skyHeight-this._background.seaTopHeight&&this._onTap():(this._coastReached=!0,this._freeze(!0),this._background.stopSpawning=!0,this._puffinBody.velocity.x=60*this._physicsScale)):(this._coastDisplaying=!0,this._flies.stopSpawning=this._sharks.stopSpawning=!0,this._background.addCoast()));var i;if(this._puffin.y>this._skyPhysicsHeight?(this._switchToWater(),i=this._insideFloatingZone()?ot.oxygenDelta:at.oxygenDelta,this._puffin.y>.97*this._totalHeight&&(this._puffinBody.velocity.y=at.topBumpVelocity),this._puffin.angle>at.minAngle&&(this._puffin.angle-=at.deltaAngle)):(this._switchToAir(),i=ot.oxygenDelta,this._puffin.y<.03*this._totalHeight&&(this._puffinBody.velocity.y=ot.topBumpVelocity),this._puffin.angle<ot.maxAngle&&(this._puffin.angle+=ot.deltaAngle)),this._updateOxygen(this.time.physicsElapsed*i),(this._puffinState===Bt.Fly||this._puffinState===Bt.Swim)&&this._tapDelta>500){var e,s=void 0,n=void 0;this._puffinState===Bt.Fly?(e=Ft.Fly2Float,s="fly2float",n=!1):(e=Ft.Swim2Float,s="float2swim",n=!0),this._previousPuffinState=this._puffinState,this._puffinState=Bt.Float,this._puffinTransition=e,this._switchPuffinAnimation(s,n).onComplete.addOnce(function(){t._puffinTransition===e&&(t._puffinTransition=null,t._switchPuffinAnimation("float"))})}this._substance===it.Water?(this.physics.arcade.overlap(this._puffin,this._sandeelsCollisionGroup,this._onSandeelOverlap,null,this),this._sharks.overlap(this._puffin,this._onSharkOverlap,this)):(this.physics.arcade.overlap(this._puffin,this._seagullsGroup,this._onSeagullOverlap,null,this),this._flies.overlap(this._puffin,this._onFlyOverlap,this),this._sharks.jumpingShark&&this._sharks.overlap(this._puffin,this._onSharkOverlap,this)),this._background.update()}},e.prototype._switchToWater=function(){if(this._substance!==it.Water){this._substance=it.Water;var t=this._puffinState===Bt.Vomit||this._puffinBody.velocity.y/this._physicsScale<400,i=t?.2:1;this._puffinBody.gravity.y=at.gravity[this._puffinSize]*this._physicsScale,this._puffinBody.maxVelocity.y=i*at.maxVelocity*this._physicsScale,this._puffinBody.drag.y=at.drag*this._physicsScale,this._puffinBody.acceleration.y=at.acceleration*this._physicsScale,!this._hasSplashed&&this._puffinBody.velocity.y/this._physicsScale>200&&(this._splashSound.play(),this._splash.revive(),this._splash.animations.currentAnim.play(),this._hasSplashed=!0)}var e=at.velocityFactor;this._puffin.y>this._skyPhysicsHeight&&this._targetVelocityFactor!==e&&(this._targetVelocityFactor=e,this._modifyVelocities(e),this._background.groupWaves.forEach(function(t){return t.animations.currentAnim.speed=24},this))},e.prototype._switchToAir=function(){this._substance!==it.Air&&(this._substance=it.Air,this._puffinBody.gravity.y=ot.gravity*this._physicsScale,this._puffinBody.maxVelocity.y=ot.maxVelocity*this._physicsScale,this._puffinBody.drag.y=ot.drag*this._physicsScale,this._puffinBody.acceleration.y=ot.acceleration*this._physicsScale);this._puffin.y<.8*this._skyPhysicsHeight&&1!==this._targetVelocityFactor&&(this._targetVelocityFactor=1,this._modifyVelocities(1),this._background.groupWaves.forEach(function(t){return t.animations.currentAnim.speed=40},this))},e.prototype._onFlyOverlap=function(t,i){this._puffinState!==Bt.Vomit&&(this._countFliesEaten++,this._addDeadFly(t.x,t.y),this._foodRewardSound.play(),i.kill(),this._updatePoints(rt.Fly))},e.prototype._onSharkOverlap=function(t,i){this._die()},e.prototype._die=function(){var t=this;0!==this._puffin.health&&(this._puffin.health=0,this._backgroundMusic.stop(),this._coastReached?this._gameWinSound.play():this._puffinDiesHitBySharkSound.play(),this._freeze(),this._updatePlayerData(),setTimeout(function(){t._pointsText.kill(),t.game.state.start("GameOver",!1,!1,t.camera.position)},800))},e.prototype._updatePlayerData=function(){a(this._points),r(this._countSandeelsEaten,this._countFliesEaten,this._countSeagullHits)},e.prototype._onSandeelOverlap=function(t,i){var e=i.data.color;this._countSandeelsEaten[e]++,this._addDeadSandeel(i.data.color,t.x,t.y),"yellow"===e?this._yellowSandeelSound.play():this._foodRewardSound.play(),i.kill(),i.revive(),i.animations.stop(),3===i.data.type?i.frameName="eel/amphora-standalone":i.frameName="eel/sand-standalone",this._updatePoints(rt.Sandeel[e])},e.prototype._onSeagullOverlap=function(t,i){var e,s=this;if(e=i.data?rt.SeagullKamikaze:rt.Seagull,this._puffinState!==Bt.Vomit){this._countSeagullHits++;var n,o;this._puffinState===Bt.Float?(o="float",n=Ft.Float2Vomit):(o="fly",n=Ft.Fly2Vomit),this._previousPuffinState=this._puffinState,this._puffinState=Bt.Vomit,this._puffinTransition=n,this._puffinHitBySeagullSound.play(),this._updatePoints(e),this._points>0&&this._switchPuffinAnimation(o+"2vomit").onComplete.addOnce(function(){s._puffinTransition=null,s._switchPuffinAnimation("vomit").onComplete.addOnce(function(){s._puffinTransition=Ft.Vomit2Float,s._switchPuffinAnimation("float2vomit",!0).onComplete.addOnce(function(){s._previousPuffinState=s._puffinState,s._puffinState=Bt.Float,s._puffinTransition=null,s._switchPuffinAnimation("float")})})})}},e.prototype._createPointsText=function(){var t=this._points.toString();if(this._pointsText)this._pointsText.visible=!0,this._pointsText.text=t;else{var i=40*f;this._pointsText=this.add.bitmapText(.5*this.game.width,.05*this.game.height,D,t,i,this._uiGroup),this._pointsText.anchor.x=.5,this._pointsText.fixedToCamera=!0}var e=this._puffin.right-.2*this._puffin.width;if(this._pointsPopupText)this._pointsPopupText.x=e;else{var s=30*f;this._pointsPopupText=this.add.bitmapText(e,0,D,"",s,this._uiGroup),this._pointsPopupText.visible=!1,this._pointsPopupText.anchor.y=1}},e.prototype._createOxygenBar=function(){this._oxygenBarPuffinOffsetX=.2*-this._puffin.width,this._oxygenBarPuffinOffsetY=.25*-this._puffin.height;var i=this._puffin.x+this._oxygenBarPuffinOffsetX,e=this._puffin.y+this._oxygenBarPuffinOffsetY;this._oxygenBarEmpty=this.sprites.add(i,e,"ui/bar-empty",this._uiGroup),this._oxygenBarFull=this.sprites.add(i,e,"ui/bar-full-blue",this._uiGroup),this._oxygenBarEmpty.visible=this._oxygenBarFull.visible=!1,this._oxygenBarPadding=.04528*this._oxygenBarEmpty.width,this._oxygenBarInnerWidth=this._oxygenBarEmpty.width-2*this._oxygenBarPadding,this._oxygenBarFull.cropRect=new t.Rectangle(0,0,this._oxygenBarPadding+this._oxygenBarInnerWidth,this._oxygenBarFull.height),this._oxygenBarDeltaPerPx=1/this._oxygenBarInnerWidth,this._oxygenBarLastValueUpdate=this._oxygen,this._oxygenBarFlashAnimation=this._oxygenBarEmpty.animations.add("flash",["ui/bar-empty","ui/bar-full-red"],10,!0)},e.prototype._updateOxygen=function(i){this._oxygen=t.Math.clamp(this._oxygen+i,0,1),1===this._oxygen?this._oxygenBarVisible&&this._hideOxygenBar():this._oxygenBarVisible?0===this._oxygen?this._oxygenBarFlashAnimation.isPlaying?this._updateOxygenBarPosition():this._flashOxygenBarStart():(this._oxygenBarFlashAnimation.isPlaying&&this._flashOxygenBarStop(),this._updateOxygenBar()):this._showOxygenBar()},e.prototype._showOxygenBar=function(){this._updateOxygenBar(),this._oxygenBarFull.visible=this._oxygenBarEmpty.visible=!0,this._oxygenBarVisible=!0},e.prototype._hideOxygenBar=function(){this._oxygenBarFull.visible=this._oxygenBarEmpty.visible=!1,this._oxygenBarVisible=!1},e.prototype._updateOxygenBarPosition=function(){this._oxygenBarEmpty.x=this._oxygenBarFull.x=this._puffin.x+this._oxygenBarPuffinOffsetX,this._oxygenBarEmpty.y=this._oxygenBarFull.y=this._puffin.y+this._oxygenBarPuffinOffsetY},e.prototype._updateOxygenBar=function(){this._updateOxygenBarPosition(),Math.abs(this._oxygenBarLastValueUpdate-this._oxygen)>this._oxygenBarDeltaPerPx&&(this._oxygenBarFull.cropRect.width=(this._oxygenBarPadding+this._oxygen*this._oxygenBarInnerWidth)/this.sprites.dynamicScale,this._oxygenBarFull.updateCrop(),this._oxygenBarLastValueUpdate=this._oxygen)},e.prototype._flashOxygenBarStart=function(){this._updateOxygenBarPosition(),this._oxygenBarFlashAnimation.play(),this._oxygenBarFull.visible=!1},e.prototype._flashOxygenBarStop=function(){this._oxygenBarFull.visible=!0,this._oxygenBarFlashAnimation.stop(!0)},e.prototype._updatePoints=function(i){var e=this;this._points+=i,this._points<=0&&(this._points=0,this._die()),this._pointsText.text=this._points.toString(),this._pointsPopupText.text=(i>0?"+":"")+i,this._pointsPopupText.y=this._puffin.y,this._coastDisplaying&&(this._pointsPopupText.x=this._puffin.right-.2*this._puffin.width),this._pointsPopupText.alpha=1,this._pointsPopupText.visible=!0,this.add.tween(this._pointsPopupText).to({alpha:0},200,t.Easing.Cubic.In,!0).onUpdateCallback(function(){e._pointsPopupText.y=e._puffin.y}).onComplete.addOnce(this._onPointsPopupTweenComplete,this),this._maybeUpdatePuffinSizeAndBlinkEyes()},e.prototype._onPointsPopupTweenComplete=function(t,i){this._pointsPopupText.visible=!1},e.prototype._maybeUpdatePuffinSizeAndBlinkEyes=function(){var t=this;this._coastDisplaying||(this._points>=nt.L?this._puffinSize!==st.L&&(this._puffinSize=st.L,this._updateGravity()):this._points>=nt.M?this._puffinSize!==st.M&&(this._puffinSize=st.M,this._updateGravity()):this._puffinSize!==st.S&&(this._puffinSize=st.S,this._updateGravity()));if(null===this._puffinTransition){var i=this._puffinAnimation._frameIndex;this._puffinState===Bt.Float&&i<3?this._switchPuffinAnimation("float-blink",!1,i).onComplete.addOnce(function(){t._puffinState===Bt.Float&&t._switchPuffinAnimation("float")}):this._puffinState===Bt.Swim&&i<3?this._switchPuffinAnimation("swim-blink",!1,i).onComplete.addOnce(function(){t._puffinState===Bt.Swim&&t._switchPuffinAnimation("swim")}):this._puffinState===Bt.Fly&&i<3&&this._switchPuffinAnimation("fly-blink",!1,i).onComplete.addOnce(function(){t._puffinState===Bt.Fly&&t._switchPuffinAnimation("fly")})}},e.prototype._updateGravity=function(){var t=this._substance===it.Water?at.gravity[this._puffinSize]:ot.gravity;this._puffinBody.gravity.y=t*this._physicsScale},e.prototype._modifyVelocities=function(t){var i=this,e=this._velocityFactor,s=t-e,n=0;this._timer.repeat(500/3,3,function(){++n;var t=e+s*(n/3),o=t/i._velocityFactor;i._velocityFactor=t,i._flies.velocityFactor=t,i._sharks.velocityFactor=t,i._background.velocityFactor=t;for(var a=0,r=i._velocityChangingGroups;a<r.length;a++){r[a].forEachAlive(i._slowdownSprite,null,o)}})},e.prototype._slowdownSprite=function(t,i){t.body.velocity.x*=i,t.lifespan/=i},e.prototype._switchPuffinAnimation=function(t,i,e){void 0===i&&(i=!1);var s=this._puffinSize,n=this._puffin.animations.getAnimation("puffin/"+s+"/"+t);this._puffinAnimation=n;var o;return o=void 0!==e?e:i?n.frameTotal-1:0,n.play(),n.reversed=i,n.frame=o,n},e.prototype._insideFloatingZone=function(){return this._puffin.y>.9*this._skyPhysicsHeight&&this._puffin.y<1.1*this._skyPhysicsHeight},e.prototype._addSplash=function(){this._splash||(this._splash=this.sprites.get("splash"),this._splash.y=this._skyHeight,this._splash.x=this._puffin.x,this._splashesGroup.add(this._splash))},e.prototype._addPuffin=function(){this._puffin||(this._puffin=this.sprites.get("puffin/S/float"),this._puffinGroup.add(this._puffin),this._puffinBody=this._puffin.body),this._puffin.health=1,this._puffinRotateWaterTween=this.add.tween(this._puffin).to({angle:-at.minAngle},at.angleTweenDuration),this._puffinRotateAirTween=this.add.tween(this._puffin).to({angle:-ot.maxAngle},ot.angleTweenDuration),this.input.onDown.add(this._onTap,this),this.input.keyboard.addKey(t.Keyboard.SPACEBAR).onDown.add(this._onTap,this),this._puffin.x=.2*this.game.width,this._puffin.y=.3*this._skyHeight,this._puffinAnimation=this._puffin.animations.getAnimation("puffin/S/float").play(),this.camera.follow(this._puffin,t.Camera.FOLLOW_TOPDOWN),this._puffinBody.velocity.y=ot.initialVelocity*this._physicsScale,this._switchToAir(),this._timer.loop(2e3,this._maybeUpdatePuffinSizeAndBlinkEyes,this)},e.prototype._onTap=function(){var t=this;if(this._hasSplashed=!1,!(this._oxygen<=0||this._puffinState===Bt.Vomit)){this._lastTapTime=this.time.now;var i=this._insideFloatingZone();if(!(i&&Math.abs(this._puffinBody.velocity.y)>50*this._physicsScale)){var e;if(this._substance===it.Air||i){if(e=ot.tapVelocity[this._puffinSize],this._puffinState===Bt.Float){var s=void 0;this._puffinTransition===Ft.Fly2Float&&(this._puffinAnimation.stop(!1),s=this._puffinAnimation._frameIndex),this._previousPuffinState=this._puffinState,this._puffinState=Bt.Fly,this._puffinTransition=Ft.Float2Fly,this._switchPuffinAnimation("fly2float",!0,s).onComplete.addOnce(function(){t._puffinTransition===Ft.Float2Fly&&(t._puffinTransition=null,t._switchPuffinAnimation("fly"))})}this._puffinRotateAirTween.start()}else{if(e=at.tapVelocity,this._puffinState===Bt.Float){var s=void 0;this._puffinTransition===Ft.Swim2Float&&(this._puffinAnimation.stop(!1),s=this._puffinAnimation._frameIndex),this._previousPuffinState=this._puffinState,this._puffinState=Bt.Swim,this._puffinTransition=Ft.Float2Swim,this._switchPuffinAnimation("float2swim",!1,s).onComplete.addOnce(function(){t._puffinTransition===Ft.Float2Swim&&(t._puffinTransition=null,t._switchPuffinAnimation("swim"))})}this._puffinRotateWaterTween.start()}this._puffinBody.velocity.y=e*this._physicsScale}}},e.prototype._createSandeels=function(){for(var t=120*c,i=0;i<this.game.width;i+=t)this._addSandeel(i);this._timer.add(4e3,this._addSandeel,this)},e.prototype._addSandeel=function(i){if(!this._coastDisplaying){void 0===i&&(i=1.1*this.game.width,this._timer.add(4e3/this._velocityFactor,this._addSandeel,this));var e,s=[{name:1,lastFrame:50},{name:2,lastFrame:50},{name:3,lastFrame:60}];e=t.Utils.chanceRoll(7)?"yellow":this.rnd.pick(M);var n,o=this.rnd.pick(s),a="eel/"+e+"/"+o.name,r=1.1*this._background.seaBottomHeight,h=this._waterHeight-r,u=.4*h,d=.6*h;n=3===o.name?this._skyHeight+r+u*Math.random():this._skyHeight+this._waterHeight-d*Math.random();var l=30*this._physicsScale*this._velocityFactor,p=this.sprites.getFirstDead(this._background.groupSeaStuff,i,n,a,1);p.data={color:e,type:o.name},this.sprites.addAnimation(p,a,o.lastFrame,50).play(),p.anchor.y=1;p.body.velocity.x=-l,p.lifespan=(i+p.width)/l*1e3,this._background.groupSeaStuff.sort("y",t.Group.SORT_ASCENDING);var f=this._sandeelsCollisionGroup.indexOf(void 0);-1===f&&(f=this._sandeelsCollisionGroup.length),this._sandeelsCollisionGroup[f]=p,p.events.onKilled.addOnce(this._onSandeelKill,this,0,f)}},e.prototype._onSandeelKill=function(t,i){this._sandeelsCollisionGroup[i]=void 0},e.prototype._addDeadFly=function(t,i){this._addDeadThing(this._deadFliesGroup,"fly",t,i,1)},e.prototype._addDeadSandeel=function(t,i,e){this._addDeadThing(this._deadSandeelsGroup,"eel/"+t+"/standalone",i,e)},e.prototype._addDeadThing=function(i,e,s,n,o){var a=this.sprites.getFirstDead(i,s,n-this.camera.y,e,o);a.alpha=1,a.anchor=kt.clone();var r=this.add.tween(a).to({x:this.game.width/2,y:this._pointsText.cameraOffset.y+this._pointsText.height/2},1e3,t.Easing.Cubic.InOut),h=this.add.tween(a).to({alpha:0},500);r.chain(h).start().onComplete.addOnce(this._killSprite,this,null,a),this.add.tween(a).to({angle:3e3},1500).start()},e.prototype._killSprite=function(t){t.kill()},e.prototype._createSeagulls=function(){this._timer.add(1e3,this._addSeagulls,this)},e.prototype._addSeagull=function(t,i,e){var s=this.sprites.getFirstDead(this._seagullsGroup,t,i,"seagull",1);s.data=!1,s.rotation=0;this.sprites.addAnimation(s,"seagull",30,40).play().frame=this.rnd.integerInRange(1,29),s.lifespan=(t+s.width)/e*1e3,s.anchor.y=kt.y,s.anchor.x=0,s.body.velocity.x=-e},e.prototype._addKamikazeSeagull=function(){var i=this.game.width,e=.2*this._skyHeight,s=this.sprites.getFirstDead(this._seagullsGroup,i,e,"seagull",1),n=-s.width,o=this.game.rnd.between(.4*this._skyHeight,this._skyHeight);s.data=!0,s.rotation=t.Math.angleBetween(n,o,i,e),s.anchor=kt.clone(),s.body.width/=.9-s.rotation,this.add.tween(s).to({x:n,y:o},1e3,null,!0).onComplete.addOnce(this._killSprite,this)},e.prototype._getRandomSeagullSpeed=function(){return(250+40*(Math.random()-.5))*this._physicsScale*this._velocityFactor},e.prototype._addSeagulls=function(){if(!this._coastDisplaying){
var i=700/this._velocityFactor,e=1.5*i,s=this.game.rnd.between(0,e),n=.94*this._skyHeight;if(t.Utils.chanceRoll(5)&&this._playTimeRatio>.1){var o=this.game.rnd.between(.3*n,.9*n),a=this._getRandomSeagullSpeed(),r=50*f,h=35*f,u=.9*r,d=.2*h;this._addSeagull(this.game.width+this.rnd.between(0,u),o+this.rnd.between(-d,d),a),this._addSeagull(this.game.width+r+this.rnd.between(0,u),o+h+this.rnd.between(-d,d),a),this._addSeagull(this.game.width+r+this.rnd.between(0,u),o-h+this.rnd.between(-d,d),a),this._addSeagull(this.game.width+2*r+this.rnd.between(0,u),o+2*h+this.rnd.between(-d,d),a),this._addSeagull(this.game.width+2*r+this.rnd.between(0,u),o-2*h+this.rnd.between(-d,d),a),s+=i}else if(t.Utils.chanceRoll(5)&&this._playTimeRatio>.3){for(var a=this._getRandomSeagullSpeed(),u=40*f,l=0;l<=n;l+=100*f){var p=this.rnd.between(0,u);this._addSeagull(this.game.width+p,l,a)}s+=i}else if(this._playTimeRatio>.6&&.2*this._playTimeRatio>Math.random())this._kamikazeSeagullSound.play(),this._addKamikazeSeagull(),s+=i;else{var l=this.game.rnd.between(0,n);if(this._addSeagull(this.game.width,l,this._getRandomSeagullSpeed()),t.Utils.chanceRoll(70)){var p=this.game.rnd.between(0,100*f),c=this.game.rnd.between(0,n);if(this._addSeagull(this.game.width+p,c,this._getRandomSeagullSpeed()),t.Utils.chanceRoll(40)){var g=this.game.rnd.between(0,100*f),_=this.game.rnd.between(0,n);this._addSeagull(this.game.width+g,_,this._getRandomSeagullSpeed())}}}this._timer.add(i+s,this._addSeagulls,this)}},Object.defineProperty(e.prototype,"_playTimeRatio",{get:function(){return this._gameDuration/24e4},enumerable:!0,configurable:!0}),e}(pt),At=function(i){function e(){return null!==i&&i.apply(this,arguments)||this}return s(e,i),e.prototype.init=function(){this.sprites=new et(this.game)},e.prototype.preload=function(){this.sprites.preloadUIAssets(),this.load.path="assets/audio/",this.load.audio("button1","button1"+dt).audio("button2","button2"+dt)},e.prototype.create=function(){this.game.scale.scaleMode=t.ScaleManager.SHOW_ALL,this.game.state.add("Play",this._createState(Pt)),this.game.state.add("StartMenu",this._createState(ft)),this.game.state.add("Credits",this._createState(ct)),this.game.state.add("Interim",this._createState(gt)),this.game.state.add("GameOver",this._createState(mt)),this.game.state.start("StartMenu",!1,!1)},e.prototype._createState=function(t){var i=new t;return i.sprites=this.sprites,i},e}(t.State);!function(i){var e=i instanceof Window?i.innerWidth:i.clientWidth,s=i instanceof Window?i.innerHeight:i.clientHeight;e/s>.65&&(e=.625*s),g=s/e;var n=window.devicePixelRatio;d=n,h=e*d,u=s*d,f=h/350,c=h/320;var o;o=f-Math.floor(f)>=.7?Math.ceil(f):Math.floor(f),l=t.Math.clamp(o,A[0],A[A.length-1]),p=f/l}(document.getElementById("game")||window),function(){var t=function(t){var i=S.filter(function(i){return 0===t.indexOf(i)});if(i.length>0)return i[0]}(navigator.language);t&&(v=t)}();var Gt=ut?t.CANVAS:t.WEBGL_MULTI;new t.Game(h,u,Gt,"game").state.add("Boot",At,!0)}(Phaser);
//# sourceMappingURL=app.js.map
